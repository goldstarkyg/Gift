<div ng-controller="CallaccountReportController">
    <style>
        .datetime .popover {
            max-width: 650px;
        }
    </style>
    <script type="text/ng-template" id="datetime_ranger.html">
        <div style="width: 700px">
            <div rg-range-picker="myDatetimeRange" labels="myDatetimeLabels"></div>
        </div>
    </script>
    
    <div class="col-lg-12 col-centered">
      	<div class="panel-default">
        	<div class="panel-body form-horizontal" ng-show="!isHidden" style="width:100%; margin: auto;">
				<div class="row form-group" style="width:100%; margin:auto;">
					<div class="form-horizontal form-validation" style="float:left; width:100%; height:20%; display:inline-block;">
						<fieldset class="fieldset1">
							<legend><h5><i class="fa fa-columns"></i>&nbsp;&nbsp;Grouping</h5></legend>
							<div class="sfield1" >
								<div class="row form-horizontal" style="margin-bottom:3px;">
									<label class="col-sm-5 control-label" style="white-space: nowrap;">Report Type : </label>
									<div class="col-sm-7">
										<select class='form-control' ng-model="report_type" ng-change="onChangeReportType()" ng-options="type for type in reporttypes">
										</select>
									</div>
								</div>
								<div class="row form-horizontal" style="margin-bottom:3px;">
									<label class="col-sm-5 control-label" style="white-space: nowrap;">Report By :</label>
									<div class="col-sm-7">
										<select class='form-control' ng-model="report_by" ng-change="onChangeReportBy()" ng-options="type for type in reportby_list">
										</select>
									</div>
								</div>
								<div class="row form-horizontal" style="margin-bottom:3px;">
									<label class="col-sm-5 control-label" style="white-space: nowrap;">Ext Type : </label>
									<div class="col-sm-7">
										<select class='form-control'  multiple   ng-model="call_sort" ng-options="type for type in extentionsorts">
										</select>
										<!--<div ng-dropdown-multiselect=""  options="extentionsorts" selected-model="call_sort" checkboxes="true" extra-settings="callsorts_hint_setting" translation-texts="callsorts_hint"></div>-->
									</div>
								</div>
								<div class="row form-horizontal" style="margin-bottom:3px;">
									<label class="col-sm-5 control-label" style="white-space: nowrap;">Building : </label>
									<div class="col-sm-7">
										<select class='form-control' ng-model="building_id"
												ng-options="value.id as value.name for (key, value) in building_list">
										</select>
									</div>
								</div>
								<div class="row form-horizontal" style="margin-bottom:3px;">
									<label class="col-sm-5 control-label" style="white-space: nowrap;">Report By(M/Y) : </label>
									<div class="col-sm-7">
										<select class='form-control' ng-model="report_year_month_by" ng-change="periodView(report_year_month_by)"
												ng-options="type for type in reportby_year_month_list">
										</select>
									</div>
								</div><br/>
							</div>
						</fieldset>
						
						<fieldset class="fieldset2">
							<legend><h5><i class="glyphicon glyphicon-filter"></i>&nbsp;&nbsp;Apply filters</h5></legend>
							<div class="sfield2">
								<!---->
								<div ng-show="monthview" class="row form-horizontal" style="margin-bottom:3px; ">
									<label class="col-sm-3 control-label" style="white-space: nowrap;">Period : </label>
									<div class="dropdown col-sm-4">
										<a class="dropdown-toggle" id="dropdown3" role="button" data-toggle="dropdown" data-target="#">
											<div class="input-group">
												<input type="text" class="form-control"  ng-model="datetime.time">
												<span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
											</div>
										</a>
										<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
											<datetimepicker ng-model="datetime.date"
															data-datetimepicker-config="{startView:'month', minView:'month', dropdownSelector: '#dropdown3' }"
															data-before-render="beforeRender($view, $dates, $leftDate, $upDate, $rightDate)"/>
										</ul>
									</div>
								</div>
								<div ng-show="yearview" class="row form-horizontal" style="margin-bottom:3px; ">
									<label class="col-sm-3 control-label" style="white-space: nowrap;">Period : </label>
									<div class="dropdown col-sm-4">
										<a class="dropdown-toggle" id="dropdown4" role="button" data-toggle="dropdown" data-target="#">
											<div class="input-group">
												<input type="text" class="form-control"  ng-model="datetime.time">
												<span class="input-group-addon"><i class="glyphicon glyphicon-calendar"></i></span>
											</div>
										</a>
										<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
											<datetimepicker ng-model="datetime.year"
															data-datetimepicker-config="{startView:'year', minView:'year', dropdownSelector: '#dropdown4' }"
															data-before-render="beforeRender($view, $dates, $leftDate, $upDate, $rightDate)"/>
										</ul>
									</div>
								</div>
								<!---->
								<div ng-show="dateview" class="row form-horizontal" style="margin-bottom:3px; ">
									<label class="col-sm-3 control-label" style="white-space: nowrap;">Period : </label>
									<div class="datetime col-sm-8">										
										<input type="text" ng-model="time_range" ui-jq="daterangepicker" ui-options="dateRangeOption" class="form-control input-sm">
									</div>
								</div>
								<div class="row form-horizontal" style="margin-bottom:3px; ">
									<label class="col-sm-3 control-label" style="white-space: nowrap;">Call Type : </label>
									<div class="col-md-9">
										<div ng-dropdown-multiselect="" options="calltypes" selected-model="call_type" checkboxes="true" extra-settings="calltypes_hint_setting" translation-texts="calltypes_hint"></div>
									</div>
								</div>
								<div class="row form-horizontal" style="margin-bottom:3px;">
									<label class="col-sm-3 control-label" style="white-space: nowrap;">Charged call : </label>
									<div class="col-md-9">
										<label class="i-switch m-t-xs m-r">
											<input type="checkbox" ng-model="callcharge_flag" checked>
											<i></i>
										</label>
									</div>
								</div>
							</div>
						
							<div class="sfield3">
								<div ng-show="valid_flag[1]" class="row form-horizontal">
									<label class="col-sm-3 control-label" style="white-space: nowrap;">Department : </label>
									<div class="col-md-9">
										<tags-input ng-model="department_tags" placeholder="Add Department" replace-spaces-with-dashes="false" style="margin-top: -5px">
											<auto-complete source="loadFilters($query, 'Department')"
														   min-length="0"
														   debounce-delay="0"
														   load-on-focus="true"
														   load-on-empty="true"
														   max-results-to-show="1000"></auto-complete>
										</tags-input>
									</div>
								</div>
								<div ng-show="valid_flag[5]" class="row form-horizontal">
									<label class="col-sm-3 control-label" style="white-space: nowrap;">Section : </label>
									<div class="col-md-9">
										<tags-input ng-model="section_tags" placeholder="Add Section" replace-spaces-with-dashes="false" style="margin-top: -5px">
											<auto-complete source="loadFilters($query, 'Section')"
														   min-length="0"
														   debounce-delay="0"
														   load-on-focus="true"
														   load-on-empty="true"
														   max-results-to-show="1000"></auto-complete>
										</tags-input>
									</div>
								</div>
								<div ng-show="valid_flag[2]" class="row form-horizontal">
									<label class="col-sm-3 control-label" style="white-space: nowrap;">Room : </label>
									<div class="col-md-9">
										<tags-input ng-model="room_tags" ng-disabled="extension_tags.length > 0" replace-spaces-with-dashes="false" on-tag-added="onChangeRoom()" on-tag-removed="onChangeRoom()" placeholder="Add Room" style="margin-top: -5px">
											<auto-complete source="loadFilters($query, 'Room')"
														   min-length="0"
														   debounce-delay="0"
														   load-on-focus="true"
														   load-on-empty="true"
														   max-results-to-show="1000"></auto-complete>
										</tags-input>
									</div>
								</div>
								<div ng-show="valid_flag[3]" class="row form-horizontal">
									<label class="col-sm-3 control-label" style="white-space: nowrap;">Extension : </label>
									<div class="col-md-9">
										<tags-input ng-model="extension_tags" ng-disabled="room_tags.length > 0" 
										min-length="1"
										replace-spaces-with-dashes="false" placeholder="Add Extension" style="margin-top: -5px" >
											<auto-complete source="loadFilters($query, 'Extension')"
														   min-length="1"
														   debounce-delay="0"
														   load-on-focus="true"
														   load-on-empty="true"
														   max-results-to-show="1000"></auto-complete>
										</tags-input>
									</div>
								</div>
								<div ng-show="valid_flag[4]" class="row form-horizontal">
									<label class="col-sm-3 control-label" style="white-space: nowrap;">Destination : </label>
									<div class="col-md-9">
										<tags-input ng-model="destination_tags" placeholder="Add a Destination" replace-spaces-with-dashes="false" style="margin-top: -5px" >
											<auto-complete source="loadFilters($query, 'Destination')"
														   min-length="0"
														   debounce-delay="0"
														   load-on-focus="true"
														   load-on-empty="true"
														   max-results-to-show="100"></auto-complete>
										</tags-input>
									</div>
								</div>
							</div>
						</fieldset>
						
						<div class="searchbox">
							<div class="row form-horizontal" style="margin-bottom:3px;">
								<button type="submit" class="btn btn-info" ng-click="onGenerateReport()">
								<i class="fa fa-file-text"></i>&nbsp;&nbsp;Generate Report&nbsp;</button>
								<!-- <button type="submit" class="btn btn-default">Cancel</button> -->
							</div> 
							<div class="row form-horizontal" style="margin-bottom:3px;">
								<button type="submit" class="btn btn-info" ng-if="auth_svc.isValidModule('app.reports.schedule')" ng-click="onShowSchedule()">
								<i class="glyphicon glyphicon-calendar"></i>&nbsp;&nbsp;Schedule Report</button>
								<button type="submit" class="btn btn-info disabled" style="border:#a9a9a9;background-color:#a9a9a9" ng-if="!auth_svc.isValidModule('app.reports.schedule')">
								<i class="glyphicon glyphicon-calendar"></i>&nbsp;&nbsp;Schedule Report</button>
								<!-- <button type="submit" class="btn btn-default">Cancel</button> -->
							</div>
							
						</div>
					</div>
				</div>
			</div>
			<div  class="wrapper" style="background-color: #ECEFF1; height: 40px; margin: 0px -15px 0px -15px">
				<div class="col-md-4">
					<i class="icon-screen-desktop"></i>&nbsp;&nbsp;Preview
				</div>

				<div class="col-md-4 text-center" ng-click="onGetFrameHeight()">
					<span class="glyphicon" ng-class="isHidden ? 'glyphicon-chevron-down' : 'glyphicon-chevron-up'" ></span>
					  <label style="cursor: pointer" ng-show="isHidden" ng-click="isHidden = !isHidden;" > Show Filters </label>
					  <label style="cursor: pointer" ng-show="!isHidden" ng-click="isHidden = !isHidden;" > Hide Filters </label>
					<span class="glyphicon" ng-class="isHidden ? 'glyphicon-chevron-down' : 'glyphicon-chevron-up'" ></span>
				</div>

				<div class="col-md-4" style="text-align: right">
					<i class="fa fa-download" style="padding-bottom:10px;"></i>&nbsp;&nbsp;Download : &nbsp;&nbsp;
					<a ng-click="onDownloadPDF()">
						<i class="fa fa-file-pdf-o" style="font-size: 18px; color:red; margin-right: 20px" aria-hidden="true"
							data-toggle="tooltip" title="Download in PDF format"></i>
					</a>
					<a ng-click="onDownloadExcel()">
						<i class="fa fa-file-excel-o" style="font-size: 18px; color:green; margin-right: 20px" aria-hidden="true"
							data-toggle="tooltip" title="Download in Excel format"></i>
					</a>
				</div>

			</div>
			
			<div class="form-horizontal" style="width:100%; margin: auto;">
				<div class="row" >
					<div ng-style="iframe_style" style="margin:0px;padding:0px;overflow:hidden">
						<iframe src="{{param}}" frameborder="0" style="overflow:hidden" height="94%" width="100%">
							<p>Your browser does not support iframes.</p>
						</iframe>
					</div>
				</div>
			</div>
		</div>
	</div>
    
</div>

