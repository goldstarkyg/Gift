<div ng-controller="ComplaintsReportController">
    <style>
        .datetime .popover {
            max-width: 650px;
        }
    </style>
    <script type="text/ng-template" id="datetime_ranger.html">
        <div style="width: 700px">
            <div rg-range-picker="myDatetimeRange" labels="myDatetimeLabels"></div>
        </div>
    </script>
    <script type="text/ng-template" id="tag-template">
        <div class="tag-template">
            <div class="right-panel">
                <span>{{data.key}}</span>
                <a class="remove-button" ng-click="$removeTag()">&#10006;</a>
            </div>
        </div>
    </script>
    <script type="text/ng-template" id="autocomplete-template">
        <div class="autocomplete-template">
            <div class="right-panel">
                <span ng-bind-html="$highlight($getDisplayText())"></span><br>
                <span style="font-size: 10px">{{data.type}}</span>
            </div>
        </div>
    </script>
    <!---------------------------------->
    <div class="col-lg-12 col-centered">
        <div class="panel-default">
            <div class="panel-body form-horizontal" ng-show="!isHidden" style="`width:100%; margin: auto;">
                <div class="row form-group" style="width:100%; margin:auto;">
                    <div class="form-horizontal form-validation" style="float:left; width:100%; height:20%; display:inline-block;">
                        <fieldset class="fieldset1" style="min-height:240px;">
                            <legend><h5><i class="fa fa-columns"></i>&nbsp;&nbsp;Grouping</h5></legend>
                            <div class="sfield1" >
                                <div class="row form-horizontal" style="margin-bottom:3px;">
                                    <label class="col-sm-5 control-label" style="white-space: nowrap;">Report Type : </label>
                                    <div class="col-sm-7">
                                        <select class='form-control' ng-model="report_type" ng-change="onChangeReportType()"
                                                ng-options="type for type in reporttypes">
                                        </select>
                                    </div>
                                </div>
                                <div class="row form-horizontal" style="margin-bottom:3px;">
                                    <label class="col-sm-5 control-label" style="white-space: nowrap;">Report By :</label>
                                    <div class="col-sm-7">
                                        <select class='form-control' ng-model="report_by" ng-change="onChangeReportBy()"
                                                ng-options="type for type in reportby_list" >
                                        </select>
                                    </div>
                                </div>
                                <div class="row form-horizontal" style="margin-bottom:3px;">
                                    <label class="col-sm-5 control-label" style="white-space: nowrap;">Group By :</label>
                                    <div class="col-sm-7">
                                        <select class='form-control' ng-model="group_by" ng-change="onChangeGroupBy()"
                                                ng-options="type for type in groupby_list" >
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </fieldset>

                        <fieldset class="fieldset2" style="min-height:240px;">
                            <legend><h5><i class="glyphicon glyphicon-filter"></i>&nbsp;&nbsp;Apply filters</h5></legend>
                            <div class="row form-horizontal">
                                <div>
                                    <div  class="row form-horizontal" style="margin-bottom:3px; ">
                                        <label class="col-sm-2 control-label" style="white-space: nowrap;">Period : </label>
                                        <div class="datetime col-sm-4">
                                            <input type="text" size="4" class="form-control" ng-model="time_range" uib-popover-template="'datetime_ranger.html'" popover-trigger="outsideClick" popover-placement="bottom">
                                        </div>
                                        <label class="col-sm-2 control-label" style="white-space: nowrap;">Status : </label>
                                        <div class="col-md-3">
                                            <div ng-dropdown-multiselect="" options="status_tags" selected-model="status" checkboxes="true" extra-settings="status_tags_hint_setting" translation-texts="status_tags_hint" ng-multiselect-disabled="status_flag"></div>
                                        </div>
                                    </div>
                                    <div  class="row form-horizontal" style="margin-bottom:3px; ">
                                        <label class="col-sm-2 control-label" style="white-space: nowrap;">Guest Type : </label>
                                        <div class="col-md-3">
                                            <div ng-dropdown-multiselect="" options="guest_type_tags" selected-model="guest_type" checkboxes="true" extra-settings="guest_type_tags_hint_setting" translation-texts="guest_type_tags_hint"></div>
                                        </div>
                                        <label class="col-sm-2 control-label" style="white-space: nowrap;">Property : </label>
                                        <div class="col-md-4">
                                            <tags-input ng-model="property_tags" placeholder="Property" replace-spaces-with-dashes="false" style="margin-top: -5px">
                                                <auto-complete source="loadFiltersValue($query, 'Property')"
                                                               min-length="0"
                                                               debounce-delay="0"
                                                               load-on-focus="true"
                                                               load-on-empty="true"
                                                               max-results-to-show="20"></auto-complete>
                                            </tags-input>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row form-horizontal">
                                <div  class="row form-horizontal">
                                    <label class="col-sm-2 control-label" style="white-space: nowrap;">Location : </label>
                                    <div class="col-md-3">
                                        <tags-input ng-model="location_tags" display-property="name"
                                                    replace-spaces-with-dashes="false" placeholder="Location"
                                                    style="margin-top: -5px"
                                                    min-length="0"
                                                    template="tag-template" >
                                            <auto-complete source="getLocationList($query)"
                                                           min-length="0"
                                                           debounce-delay="0"
                                                           load-on-focus="true"
                                                           load-on-empty="true"
                                                           max-results-to-show="100"
                                                           template="autocomplete-template" ></auto-complete>
                                        </tags-input>
                                    </div>
                                    <label class="col-sm-2 control-label"  ng-show="category_view" style="white-space: nowrap;">Department : </label>
                                    <div class="col-md-4"  ng-show="category_view">
                                        <tags-input ng-model="department_tags" placeholder="Department" replace-spaces-with-dashes="false" style="margin-top: -5px">
                                            <auto-complete source="loadFiltersValue($query, 'Departments')"
                                                           min-length="0"
                                                           debounce-delay="0"
                                                           load-on-focus="true"
                                                           load-on-empty="true"
                                                           max-results-to-show="100"></auto-complete>
                                        </tags-input>
                                    </div>
                                </div>
                                <div class="row form-horizontal">
                                    <label class="col-sm-2 control-label" style="white-space: nowrap;">Serverity : </label>
                                    <div class="col-md-3">
                                        <tags-input ng-model="serverity_tags" placeholder="Serverity" replace-spaces-with-dashes="false" style="margin-top: -5px">
                                            <auto-complete source="loadFiltersValue($query, 'Serverity')"
                                                           min-length="0"
                                                           debounce-delay="0"
                                                           load-on-focus="true"
                                                           load-on-empty="true"
                                                           max-results-to-show="100"></auto-complete>
                                        </tags-input>
                                    </div>
                                    <label class="col-sm-2 control-label" style="white-space: nowrap;" ng-hide="report_by == 'Sub-complaint'">Main Category : </label>
                                    <div class="col-md-4" ng-hide="report_by == 'Sub-complaint'">
                                        <tags-input ng-model="main_category_tags" placeholder="Main Category" min-length="0" replace-spaces-with-dashes="false" style="margin-top: -5px">
                                            <auto-complete source="loadFiltersValue($query, 'MainCategory')"
                                                           min-length="0"
                                                           debounce-delay="0"
                                                           load-on-focus="true"
                                                           load-on-empty="true"
                                                           max-results-to-show="20"></auto-complete>
                                        </tags-input>
                                    </div>
                                </div>
                                <div  class="row form-horizontal">
                                    <label  class="col-sm-2 control-label" ng-show="category_view" style="white-space: nowrap;">Category : </label>
                                    <div class="col-md-3" ng-show="category_view">
                                        <tags-input ng-model="category_tags" placeholder="Category" replace-spaces-with-dashes="false" style="margin-top: -5px">
                                            <auto-complete source="loadFiltersValue($query, 'Category')"
                                                           min-length="0"
                                                           debounce-delay="0"
                                                           load-on-focus="true"
                                                           load-on-empty="true"
                                                           max-results-to-show="100"></auto-complete>
                                        </tags-input>
                                    </div>
                                    <label class="col-sm-2 control-label" ng-show="category_view" style="white-space: nowrap;">Sub Category : </label>
                                    <div class="col-md-4" ng-show="category_view" >
                                        <tags-input ng-model="sub_category_tags" placeholder="Sub Category" replace-spaces-with-dashes="false" style="margin-top: -5px">
                                            <auto-complete source="loadFiltersValue($query, 'SubCategory')"
                                                           min-length="0"
                                                           debounce-delay="0"
                                                           load-on-focus="true"
                                                           load-on-empty="true"
                                                           max-results-to-show="100"></auto-complete>
                                        </tags-input>
                                    </div>
                                </div>
                            </div>
                        </fieldset>

                        <div class="searchbox">
                            <div class="row form-horizontal" style="margin-bottom:3px;">
                                <button type="submit" class="btn btn-info" ng-click="onGenerateReport()">
                                    <i class="fa fa-file-text"></i>&nbsp;&nbsp;Generate Report&nbsp;</button>
                                <!-- <button type="submit" class="btn btn-default">Cancel</button> -->
                            </div>
                            <div class="row form-horizontal" style="margin-bottom:3px;">
                                <button type="submit" class="btn btn-info" ng-if="auth_svc.isValidModule('app.reports.schedule')" ng-click="onShowSchedule()">
                                    <i class="glyphicon glyphicon-calendar"></i>&nbsp;&nbsp;Schedule Report</button>
                                <button type="submit" class="btn btn-info disabled" style="border:#a9a9a9;background-color:#a9a9a9" ng-if="!auth_svc.isValidModule('app.reports.schedule')">
                                    <i class="glyphicon glyphicon-calendar"></i>&nbsp;&nbsp;Schedule Report</button>
                                <!-- <button type="submit" class="btn btn-default">Cancel</button> -->
                            </div>

                        </div>
                    </div>
                </div>
            </div>
            <div  class="wrapper" style="background-color: #ECEFF1; height: 40px; margin: 0px -15px 0px -15px">
                <div class="col-md-4">
                    <i class="icon-screen-desktop"></i>&nbsp;&nbsp;Preview
                </div>

                <div class="col-md-4 text-center" ng-click="onGetFrameHeight()">
                    <span class="glyphicon" ng-class="isHidden ? 'glyphicon-chevron-down' : 'glyphicon-chevron-up'" ></span>
                    <label style="cursor: pointer" ng-show="isHidden" ng-click="isHidden = !isHidden;" > Show Filters </label>
                    <label style="cursor: pointer" ng-show="!isHidden" ng-click="isHidden = !isHidden;" > Hide Filters </label>
                    <span class="glyphicon" ng-class="isHidden ? 'glyphicon-chevron-down' : 'glyphicon-chevron-up'" ></span>
                </div>

                <div class="col-md-4" style="text-align: right">
                    <!--<a href="/frontend/report/callaccount_pdfreport?{{param}}"><i class="fa fa-file-pdf-o" style="font-size: 30px;" aria-hidden="true"></i></a>-->
                    <i class="fa fa-download" style="padding-bottom:10px;"></i>&nbsp;&nbsp;Download : &nbsp;&nbsp;
                    <!--<a href="/frontend/report/guestservice_pdfreport?{{param}}"><i class="fa fa-file-pdf-o" style="font-size: 30px;" aria-hidden="true"></i></a>-->
                    <!--<a href="/frontend/report/guestservice_excelreport?{{param}}"><i class="fa fa-file-excel-o" style="font-size: 30px; margin-left: 20px; margin-right: 10px" aria-hidden="true"></i></a>-->
                    <a ng-click="onDownloadPDF()">
                        <i class="fa fa-file-pdf-o" style="font-size: 18px; color:red; margin-right: 20px" aria-hidden="true"
                           data-toggle="tooltip" title="Download in PDF format"></i>
                    </a>
                    <a ng-click="onDownloadExcel()">
                        <i class="fa fa-file-excel-o" style="font-size: 18px; color:green; margin-right: 20px" aria-hidden="true"
                           data-toggle="tooltip" title="Download in Excel format"></i>
                    </a>
                </div>

            </div>

            <!--<div class="line line-dashed b-b line-lg"></div>-->
            <div class="form-horizontal" style="width:97%; margin: auto;">
                <div class="row" >
                    <div style="{{iframe_style}}" >
                        <iframe src="{{param}}" frameborder="0" style="overflow:hidden" height="94%" width="100%">
                            <p>Your browser does not support iframes.</p>
                        </iframe>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!----------------------------------->

</div>
